!function(){function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var t=document.createElement("style");t.innerHTML='code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px white;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}pre[class*=language-]::selection,pre[class*=language-] ::selection,code[class*=language-]::selection,code[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number,.token.constant,.token.symbol,.token.deleted{color:#905}.token.selector,.token.attr-name,.token.string,.token.char,.token.builtin,.token.inserted{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.function,.token.class-name{color:#dd4a68}.token.regex,.token.important,.token.variable{color:#e90}.token.important,.token.bold{font-weight:bold}.token.italic{font-style:italic}.token.entity{cursor:help}body::-webkit-scrollbar{display:none}body{scrollbar-width:none}\n',document.head.appendChild(t),System.register(["./vendor-legacy.c560e160.js"],(function(){"use strict";var t,n,o,a,l,r,s,i,u,c,d,p,g,m,v,f,b,k,h,y,w,S,j,U,x,P,z,O;return{setters:[function(e){t=e.d,n=e.r,o=e.o,a=e.w,l=e.c,r=e.a,s=e.t,i=e.b,u=e.n,c=e.P,d=e.e,p=e.u,g=e.f,m=e.g,v=e.h,f=e.i,b=e.F,k=e.j,h=e.k,y=e.l,w=e.m,S=e.p,j=e.L,U=e.q,x=e.s,P=e.v,z=e.x,O=e.y}],execute:function(){var q=t({props:{source:{type:String,default:""}},setup(e){const t=e,d=n(null);return o((()=>{a((()=>(u((()=>{c.highlightElement(d.value)})),t.source)))})),(e,n)=>(i(),l("pre",null,[r("code",{ref:(e,t)=>{t.code=e,d.value=e},class:"language-javascript"},s(t.source),513)]))}});function L(e,t){const n={};for(const o in e)n[o]=d({get:()=>e[o],set(e){t(`update:${o}`,e)}});return n}const N=["data-gutter"];var A=t({props:{inside:{type:String,default:"inside",required:!0},source:{type:String,default:""},title:{type:String,default:""},preamble:{type:String,default:""},version:{type:String,default:"16.6.0"}},emits:["update:inside","update:source","update:title","update:preamble","update:version","update:loading"],setup(e,{emit:t}){const s=e,{inside:u,source:c,title:g,preamble:m,version:v}=L(s,t),f=n(null),b=d({get:()=>v.value.trim().split(".").map(((e,t)=>0===t?e:"x")).join("."),set(e){v.value=e}});return t("update:loading",!0),o((async()=>{const e=window.RunKit.createNotebook({element:f.value,preamble:m.value,title:g.value,gutterStyle:u.value,source:c.value,nodeVersion:b.value});e.onLoad=async n=>{t("update:loading",!1),e.evaluate()},e.onSave=async()=>{e.getSource().then((e=>c.value=e)),e.getNodeVersion().then((e=>b.value=e))},a((()=>e.setSource(c.value))),a((()=>e.setTitle(g.value))),a((()=>e.setPreamble(m.value))),a((()=>e.setNodeVersion(b.value)))})),(e,t)=>(i(),l("pre",{class:"embed","data-gutter":p(u)},[r("div",{ref:(e,t)=>{t.element=e,f.value=e}},null,512)],8,N))}}),D=t({props:{inside:{type:String,default:"inside",required:!0},source:{type:String,default:""},title:{type:String,default:""},preamble:{type:String,default:""},version:{type:String,default:"16.6.0"}},emits:["update:inside","update:source","update:title","update:preamble","update:version"],setup(e,{emit:t}){const o=e,{inside:a,source:r,title:s,preamble:u,version:c}=L(o,t),d=n(!0);return(e,t)=>(i(),l(b,null,[d.value?(i(),g(q,{key:0,source:p(r)},null,8,["source"])):m("",!0),v(A,{source:p(r),"onUpdate:source":t[0]||(t[0]=e=>f(r)?r.value=e:null),inside:p(a),"onUpdate:inside":t[1]||(t[1]=e=>f(a)?a.value=e:null),title:p(s),"onUpdate:title":t[2]||(t[2]=e=>f(s)?s.value=e:null),preamble:p(u),"onUpdate:preamble":t[3]||(t[3]=e=>f(u)?u.value=e:null),version:p(c),"onUpdate:version":t[4]||(t[4]=e=>f(c)?c.value=e:null),"onUpdate:loading":t[5]||(t[5]=e=>d.value=e)},null,8,["source","inside","title","preamble","version"])],64))}});class M{constructor(){e(this,"pending",!1),e(this,"fulfilled",!1),e(this,"rejected",!1),e(this,"data",{}),e(this,"error",{}),e(this,"p",Promise.resolve())}setP(e){this.p=e}equalP(e){return this.p===e}reLoad(){}}const B=n(new Date);setInterval((()=>{B.value=new Date}),100);const E={key:0,style:{position:"absolute","background-color":"aliceblue",padding:"4px 6px"}};const F=O(t({setup(e){z.apiCache=!0;const t=k({source:"",inside:"inside",title:"",preamble:"",version:"16.6.0"}),o=function({deps:e,getter:t,dataMergeFun:n=((e,t)=>t),defaultData:o}){const l=new M;return void 0!==o&&(l.data=o),h(((o,r)=>{if(e){if(e)if(e instanceof Function){const n=e();Array.isArray(n)&&0===n.length||y(e,(()=>s(t())),{immediate:!0})}else y(e,(()=>s(t())),{immediate:!0})}else a((()=>s(t())));function s(e){l.setP(e),l.pending=!0,l.fulfilled=!1,l.rejected=!1,u(r),e.then((t=>{l.equalP(e)&&(l.pending=!1,l.fulfilled=!0,l.data=n(l.data,t))})).catch((t=>{l.equalP(e)&&(l.pending=!1,l.rejected=!0,l.error=t)})).finally((()=>{l.equalP(e)&&r()}))}return l.reLoad=()=>{s(t())},{get:()=>(o(),l),set(e){console.warn("不可设置值")}}}))}({deps:()=>[],getter:()=>U.setBlockAttrs({id:S(),attrs:{"custom-config":JSON.stringify(t)}})}),r=n(Date.now());a((()=>{o.value,r.value=Date.now()+3e3}));const c=d((()=>!!o.value.pending||!(!o.value.fulfilled&&!o.value.rejected)&&r.value>B.value.getTime()));return w((async()=>{const e=S(),[n,l]=function(e=document.location.toString(),t){const n=new URL(e),o=n.searchParams,a=k(t);o.forEach(((e,t)=>{try{a[t]=atob(e)}catch(n){a[t]=e}}));const l=d((()=>(Object.keys(a).forEach((e=>{const t=btoa(a[e]||"");o.set(e,t)})),n.href)));return[a,l]}(void 0,{code:"{}"});a((()=>history.replaceState("","",l.value))),Object.assign(t,JSON.parse(j.decompressFromBase64(n.code)||"{}")),a((()=>{n.code=j.compressToBase64(JSON.stringify(t))})),e?(await U.getBlockAttr(e,"custom-config").then((e=>{if(e){const n=x(e.value);n?Object.assign(t,JSON.parse(n)):console.error("decode 失败, code:",e.value)}})),P()===P.env.siYuan&&y(t,(()=>o.value.reLoad()))):console.error("获取当前挂件快id失败，不再尝试调用思源 api 保存代码")})),(e,n)=>(i(),l(b,null,[p(c)?(i(),l("div",E,s(p(o).pending?"保存中":p(o).fulfilled?"保存成功":p(o).rejected?"保存失败":""),1)):m("",!0),v(D,{source:p(t).source,"onUpdate:source":n[0]||(n[0]=e=>p(t).source=e),inside:p(t).inside,"onUpdate:inside":n[1]||(n[1]=e=>p(t).inside=e),title:p(t).title,"onUpdate:title":n[2]||(n[2]=e=>p(t).title=e),preamble:p(t).preamble,"onUpdate:preamble":n[3]||(n[3]=e=>p(t).preamble=e),version:p(t).version,"onUpdate:version":n[4]||(n[4]=e=>p(t).version=e)},null,8,["source","inside","title","preamble","version"])],64))}}));F.mount("#app"),F.config}}}))}();
//# sourceMappingURL=index-legacy.d0263aca.js.map
