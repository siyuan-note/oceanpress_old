import("data:text/javascript;base64,Cg==");import{d as e,r as t,o as a,w as s,a as n,c as r,b as o,t as i,n as l,P as u,e as c,u as d,f as p,g as v,h as g,i as m,F as f,j as b,k as y,l as S,L as h,m as U,p as j,q as N,s as O,v as k}from"./vendor.c10c1e99.js";var w=e({props:{source:{type:String,default:""}},setup(e){const c=e,d=t(null);return a((()=>{s((()=>(l((()=>{u.highlightElement(d.value)})),c.source)))})),(e,t)=>(n(),r("pre",null,[o("code",{ref:d,class:"language-javascript"},i(c.source),513)]))}});function B(e,t){const a={};for(const s in e)a[s]=c({get:()=>e[s],set(e){t(`update:${s}`,e)}});return a}const J=["data-gutter"];var q=e({props:{inside:{type:String,default:"inside",required:!0},source:{type:String,default:""},title:{type:String,default:""},preamble:{type:String,default:""},version:{type:String,default:"16.6.0"}},emits:["update:inside","update:source","update:title","update:preamble","update:version","update:loading"],setup(e,{emit:i}){const l=e,{inside:u,source:p,title:v,preamble:g,version:m}=B(l,i),f=t(null),b=c({get:()=>m.value.trim().split(".").map(((e,t)=>0===t?e:"x")).join("."),set(e){m.value=e}});return i("update:loading",!0),a((async()=>{const e=window.RunKit.createNotebook({element:f.value,preamble:g.value,title:v.value,gutterStyle:u.value,source:p.value,nodeVersion:b.value});e.onLoad=async t=>{i("update:loading",!1),e.evaluate()},e.onSave=async()=>{e.getSource().then((e=>p.value=e)),e.getNodeVersion().then((e=>b.value=e))},s((()=>e.setSource(p.value))),s((()=>e.setTitle(v.value))),s((()=>e.setPreamble(g.value))),s((()=>e.setNodeVersion(b.value)))})),(e,t)=>(n(),r("pre",{class:"embed","data-gutter":d(u)},[o("div",{ref:f},null,512)],8,J))}}),E=e({props:{inside:{type:String,default:"inside",required:!0},source:{type:String,default:""},title:{type:String,default:""},preamble:{type:String,default:""},version:{type:String,default:"16.6.0"}},emits:["update:inside","update:source","update:title","update:preamble","update:version"],setup(e,{emit:a}){const s=e,{inside:o,source:i,title:l,preamble:u,version:c}=B(s,a),b=t(!0);return(e,t)=>(n(),r(f,null,[b.value?(n(),p(w,{key:0,source:d(i)},null,8,["source"])):v("",!0),g(q,{source:d(i),"onUpdate:source":t[0]||(t[0]=e=>m(i)?i.value=e:null),inside:d(o),"onUpdate:inside":t[1]||(t[1]=e=>m(o)?o.value=e:null),title:d(l),"onUpdate:title":t[2]||(t[2]=e=>m(l)?l.value=e:null),preamble:d(u),"onUpdate:preamble":t[3]||(t[3]=e=>m(u)?u.value=e:null),version:d(c),"onUpdate:version":t[4]||(t[4]=e=>m(c)?c.value=e:null),"onUpdate:loading":t[5]||(t[5]=e=>b.value=e)},null,8,["source","inside","title","preamble","version"])],64))}});const L=k(e({setup(e){O.apiCache=!0;const t=b({source:"",inside:"inside",title:"",preamble:"",version:"16.6.0"});return y((async()=>{const e=S(),[a,n]=function(e=document.location.toString(),t){const a=new URL(e),s=a.searchParams,n=b(t);s.forEach(((e,t)=>{try{n[t]=atob(e)}catch(a){n[t]=e}}));const r=c((()=>(Object.keys(n).forEach((e=>{const t=btoa(n[e]||"");s.set(e,t)})),a.href)));return[n,r]}(void 0,{code:"{}"});s((()=>history.replaceState("","",n.value))),Object.assign(t,JSON.parse(h.decompressFromBase64(a.code)||"{}")),s((()=>{a.code=h.compressToBase64(JSON.stringify(t))})),e?(U.getBlockAttr(e,"custom-config").then((e=>{if(e){const a=j(e.value);a?Object.assign(t,JSON.parse(a)):console.error("decode 失败, code:",e.value)}})).catch((e=>{console.error("查询config失败",e)})),N()===N.env.siYuan&&s((()=>{U.setBlockAttrs({id:S(),attrs:{"custom-config":JSON.stringify(t)}}).then((e=>{}))}))):console.error("获取当前挂件快id失败，不再尝试调用思源 api 保存代码")})),(e,a)=>(n(),p(E,{source:d(t).source,"onUpdate:source":a[0]||(a[0]=e=>d(t).source=e),inside:d(t).inside,"onUpdate:inside":a[1]||(a[1]=e=>d(t).inside=e),title:d(t).title,"onUpdate:title":a[2]||(a[2]=e=>d(t).title=e),preamble:d(t).preamble,"onUpdate:preamble":a[3]||(a[3]=e=>d(t).preamble=e),version:d(t).version,"onUpdate:version":a[4]||(a[4]=e=>d(t).version=e)},null,8,["source","inside","title","preamble","version"]))}}));L.mount("#app"),L.config;
//# sourceMappingURL=index.e204c33a.js.map
